<html>
<head>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async>
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    TeX: { equationNumbers: { autoNumber: "AMS" }},
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    },
    "HTML-CSS": { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em"
  });
</script>
<!--<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">-->
<!--<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">-->
<!--<link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">-->
<link rel="stylesheet" href="../../css/style_b.css">
</head>

<body>
	 <div id="pagebody">
	<div id="header">
		<h1><a href="index.html"><img src="https://yoshikazukashiwazaki.github.io/science_study/images/bg_img_2.png"></a></h1>
	</div>
<H1>
物理のノート
</H1>
		 <H2><b>逆行列</b></H2>
 <H3><b>逆行列の数値計算</b></H3>
<p></p>
逆行列$A^{-1}$は,行列式と<a href="https://yoshikazukashiwazaki.github.io/science_study/formula/m/matrix.html">余因子（Cofactor）</a>を用いて,<a href="https://yoshikazukashiwazaki.github.io/science_study/formula/m/InverseMatrices.html">次のように定義</a>される.<br>
次の$2\times2$正方行列の場合,
\begin{equation}
A=
\begin{pmatrix}
a & b\\
c & d
\end{pmatrix}
,
\end{equation}
逆行列$A^{-1}$は次のようになる.
<p></p>
\begin{equation}
A^{-1}
=\frac{1}{\lvert A \rvert }
\begin{pmatrix}
C_{1,1} & C_{2,1}\\
C_{1,2} & C_{2,2}
\end{pmatrix}
=\frac{1}{\lvert A \rvert }
\begin{pmatrix}
(-1)^{1+1}\Delta_{1,1} & (-1)^{2+1}\Delta_{2,1}\\
(-1)^{1+2}\Delta_{1,2} & (-1)^{2+2}\Delta_{2,2}
\end{pmatrix}
=
\frac{1}{ad-bc }
\begin{pmatrix}
d & (-1)b\\
(-1)c & a
\end{pmatrix}\\
=
\frac{1}{ad-bc }
\begin{pmatrix}
d & -b\\
-c & a
\end{pmatrix}
\end{equation}
この定義が示すように,逆行列が存在するには, 行列式$\lvert A \rvert \ne 0$が条件となる.
		 
<p></p>  
定義に従って,次の$2\times 2$正方行列の逆行列を求める.
\begin{equation}
A=
\begin{pmatrix}
1 & 3\\
2 & 4
\end{pmatrix}
\end{equation}
とすると,
\begin{equation}
A^{-1}=\frac{1}{1\cdot 4-3\cdot 2}
\begin{pmatrix}
4 & (-1)3\\
(-1)2 & 1
\end{pmatrix}\\
=-\frac{1}{2}
\begin{pmatrix}
4 & -3\\
-2 & 1
\end{pmatrix}
=
\begin{pmatrix}
-2 & \frac{3}{2}\\
1 & -\frac{1}{2}
\end{pmatrix}
\end{equation}
<br>
ところで,この$2\times 2$正方行列の逆行列は,<a href="https://yoshikazukashiwazaki.github.io/science_study/formula/m/determinant.html">Gauss-Jordan消去法（掃き出し法）</a>で用いた数値計算を次のように改良して求めることができる.
<p></p>
<pre><code class="prettyprint">
#!/usr/bin/python2.7
# -*- coding: utf-8 -*-
import numpy as np
print('=============')
print('2 * 2 array')
print('=============')
array2 = np.array([[1.,3.,1.,0.],[2.,4.,0.,1.]])
arrayp = np.array([[0.,0.],[0.,0.]])
arrayq = np.array([[0.,0.],[0.,0.]])
tmp = np.array([[0.,0.,0.,0.],[0.,0.,0.,0.]])
print('array2 =')
print(array2)
print('=====================================')
print('Gauss-Jordan Elimination（掃き出し法)')
print('=====================================')
#n = 2  元の数
det = 1.0  
for k in range(0,2,1): 
    for i in range(k,2,1):
        if i !=k:
            if abs(array2[k,k]) < abs(array2[i,k]):
    # j列の範囲をk列目から3列目に変更する.                
                for j in range(k,4,1):
                    tmp[i,j] = array2[k,j]
                    array2[k,j] = array2[i,j]
                    array2[i,j] = tmp[i,j]           

    arrayp[k,k] = array2[k,k]
    det = det * arrayp[k,k]
    # j列の範囲をk列目から3列目に変更する.
    for j in range(k,3,1):
        array2[k,j+1] = array2[k,j+1] / arrayp[k,k]
        print('array2 =') 
        print(array2)     
    array2[k,k] = 1

    for i in range(0,2,1):
        arrayq[k,k] = array2[i,k]
        # j列の範囲をk列目から3列目に変更する.
        for j in range(k,4,1):
            if i != k:
                array2[i,j] = array2[i,j] - array2[k,j] * arrayq[k,k]
                print('array2 =') 
                print(array2)           
            else:
                array2[i,j] = array2[i,j] 
                
#print('x_1 = {0}, x_2 = {1}, x_3 = {2}'.format(array2[0,3], array2[1,3], array2[2,3]))                
##行列式の計算結果
print('=====================')
print('determinant of matrix')
print('=====================')
print('det = {}'.format(det)) 
</code></pre> 
		 <p></p>
<a href="https://yoshikazukashiwazaki.github.io/science_study/index.html">index.htmlに戻る</a>
<div id="footer"><small>Physics & Mathematics - Yoshikazu Kashiwazaki</small></div>
	 </div>
 </div>
 </body>
</html>
